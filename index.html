<!doctype html>
<html>
   <head>
    <script type="text/javascript" src="js/three.js"></script>
    <script src="//unpkg.com/three-trackballcontrols-web/dist/three-trackballcontrols.min.js"></script>
    <script type="text/javascript" src="//unpkg.com/three-forcegraph"></script>
    <!--script type="text/javascript" src="js/loader.js"></script>
    <script type="text/javascript" src="js/main.js"></script -->
    <link rel="stylesheet" type="text/css" href="css/three.css">
   </head>
   <body>
       <div id="config">
                <select id="graph_type" onchange="rerender()">
                        <option value="sphere">sphere</option>
                        <option value="cube">cube</option>
                </select>
                <select id="graph_node_color"  onchange="rerender()">
                    <option value="red">red</option>
                    <option value="white">white</option>
                    <option value="brow">brow</option>
                    <option value="pink">pink</option>
                    <option value="brownDark">brownDark</option>
                    <option value="blue">blue</option>
                </select>
                <select id="graph_line_color"  onchange="rerender()">
                        <option value="red">red</option>
                        <option value="white">white</option>
                        <option value="brow">brow</option>
                        <option value="pink">pink</option>
                        <option value="brownDark">brownDark</option>
                        <option value="blue">blue</option>
                    </select>
       </div>
       
        <!--div id="world"></div-->
        <div id="3d-graph"></div>

        <script>
            var Colors = {
	            red:0xf25346,
	            white:0xd8d0d1,
	            brown:0x59332e,
	            pink:0xF5986E,
	            brownDark:0x23190f,
	            blue:0x68c3c0,
	        };
            // Gen random data
            var loader = new THREE.FileLoader();
            var dataObject;
            var geometry = new THREE.SphereGeometry( 5, 64, 64 );
            var material =  new THREE.MeshPhongMaterial({color:0x00ff00, shading:THREE.FlatShading});
            var sphere = new THREE.Mesh( geometry, material );
            
            var geometry_box = new THREE.BoxGeometry( 10, 10, 10 );
            var cube = new THREE.Mesh( geometry_box, material );
            
            //var 
            var graph_config={
                'color':0xd8d0d1,
                'type':cube
            };
            //load a text file and output the result to the console
            loader.load(
	        // resource URL
	        'data/miserables.json',

	            // onLoad callback
	        function ( data ) {
                dataObject=JSON.parse(data);
                createGraph(dataObject,graph_config);
	            },

	            // onProgress callback
	        function ( xhr ) {
		        console.log( (xhr.loaded / xhr.total * 100) + '% loaded' );
	            },

	            // onError callback
	        function ( err ) {
		        console.error( 'An error happened' );
	            }
            );

            function createGraph(data,config){
            const N = 300;
            
            const gData=data;
            const Graph = new ThreeForceGraph()
              .graphData(gData)
              .nodeColor(config.color)
              .nodeThreeObject(config.type);
            // Setup renderer
            const renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('3d-graph').appendChild(renderer.domElement);
            // Setup scene
            const scene = new THREE.Scene();
            scene.add(Graph);
            scene.add(new THREE.AmbientLight(0xbbbbbb));
            // Setup camera
            const camera = new THREE.PerspectiveCamera();
            camera.aspect = window.innerWidth/window.innerHeight;
            camera.updateProjectionMatrix();
            camera.lookAt(Graph.position);
            camera.position.z = Math.cbrt(N) * 100;
            // Add camera controls
            const tbControls = new TrackballControls(camera, renderer.domElement);
            // Kick-off renderer
            (function animate() { // IIFE
              Graph.tickFrame();
              // Frame cycle
              tbControls.update();
              renderer.render(scene, camera);
              requestAnimationFrame(animate);
            })();
        }



          </script>


   </body>
   
</html>